<?xml version="1.0" encoding="ISO-8859-1"?>
<?xml-stylesheet type="text/xsl" href="rpcalls.xsl"?>

<application namespace="GNET">

	<!--  ****************************************************************************  -->
	<!--  Protocols and Rpcs used only in Linkd Deliveryd and Client				 	-->
	<!--  Protocols and Rpcs typeid is 1 - 64 , 128-500									-->
	<!--  ****************************************************************************  -->

	<protocol debug="1" name="StatusAnnounce" maxsize="32" prior="2" type="6">
		<variable name="userid" type="int" />
		<variable name="localsid" type="int" />
		<variable name="status" type="byte" />
	</protocol>

	<protocol debug="1" name="VIPAnnounce" maxsize="1024" prior="2" type="8045">
                <variable name="userid" type="int" />
                <variable name="aid" type="int" />
                <variable name="zoneid" type="int" />
                <variable name="currenttime" type="int" />
                <variable name="starttime" type="int" />
                <variable name="endtime" type="int" />
                <variable name="status" type="int" />
                <variable name="viplevel" type="int" />
                <variable name="totalcash" type="int" />
                <variable name="recenttotalcash" type="int" />
                <variable name="infolack" type="int" />
                <variable name="reserved1" type="int" />
        </protocol>
	
	<protocol debug="1"  name="KickoutUser" maxsize="32" prior="2" type="10">
		<variable name="userid" type="int"/>
		<variable name="localsid" type="int"/>
		<variable name="cause" type="byte" default="32"/>
	</protocol>
			
	<rpcdata name="UserLoginArg">
		<variable name="userid" type="int" default="-1"/>
		<variable name="localsid" type="int" default="0"/>
		<variable name="blkickuser" type="byte"	default="0"/>
		<variable name="freecreatime" type="int" default="0"/>
	</rpcdata>  
	<rpcdata name="UserLoginRes">
		<variable name="retcode" type="byte" default="-1"/>
		<variable name="remain_playtime" type="int" default="0"/>
		<variable name="func" type="int" default="0"/>
		<variable name="funcparm" type="int" default="0"/>
		<variable name="blIsGM" type="byte"/>
		<variable name="free_time_left" type="int" default="0"/>
		<variable name="free_time_end" type="int" default="0"/>
		<variable name="creatime" type="int" default="0"/>
		<variable name="adduppoint" type="int" default="0"/>
		<variable name="soldpoint" type="int" default="0"/>
	</rpcdata> 
	<rpc debug="1" name="UserLogin" type="15" argument="UserLoginArg" result="UserLoginRes" maxsize="128" prior="2" timeout="10"/>
	<rpcdata name="MatrixPasswd2Arg">
		<variable name="account" type="Octets" default="Octets(0)"/>
		<variable name="challenge" type="Octets" default="Octets(0)"/>
		<variable name="loginip" type="int" default="0"/>
    </rpcdata>
    <rpcdata name="MatrixPasswd2Res">
		<variable name="retcode" type="int" default="-1"/>
		<variable name="userid" type="int" default="-1"/>
		<variable name="algorithm" type="int" default="0"/>
		<variable name="response" type="Octets" default="Octets(0)"/>
		<variable name="matrix" type="Octets" default="Octets(0)"/>
		<variable name="seed" type="Octets" default="Octets(0)"/>
		<variable name="pin" type="Octets" default="Octets(0)"/>
		<variable name="rtime" type="int" default="0"/>
		<variable name="currenttime" type="int" default="0"/>
		<variable name="forbid" type="GRoleForbidVector"/>
		<variable name="last_used_elec_number" type="Octets" default="0"/>
		<variable name="ssoinfo" type="Octets" default="Octets(0)"/>
	</rpcdata>
	<rpc debug="1" name="MatrixPasswd2" type="8066" argument="MatrixPasswd2Arg" result="MatrixPasswd2Res" maxsize="1024" prior="2" timeout="30"/>
	<rpcdata name="UserLogin2Arg">
		<variable name="userid" type="int" default="-1"/>
		<variable name="localsid" type="int" default="0"/>
		<variable name="blkickuser" type="byte"	default="0"/>
		<variable name="freecreatime" type="int" default="0"/>
		<variable name="used_elec_number" type="Octets" default="0"/>
		<variable name="reserved1" type="int"/>
		<variable name="reserved2" type="Octets"/>
	</rpcdata>  
	<rpcdata name="UserLogin2Res">
		<variable name="retcode" type="int" default="-1"/>
		<variable name="remain_playtime" type="int" default="0"/>
		<variable name="func" type="int" default="0"/>
		<variable name="funcparm" type="int" default="0"/>
		<variable name="blIsGM" type="byte"/>
		<variable name="free_time_left" type="int" default="0"/>
		<variable name="free_time_end" type="int" default="0"/>
		<variable name="creatime" type="int" default="0"/>
		<variable name="adduppoint" type="int" default="0"/>
		<variable name="soldpoint" type="int" default="0"/>
		<variable name="auth" type="MByteVector"/>
		<variable name="gender" type="byte" default="0"/>
		<variable name="remain_coupon" type="int" default="0"/>
		<variable name="today_exchange_coupon" type="int" default="-1"/>
		<variable name="today_remain_exchange_coupon" type="int" default="-1"/>
		<variable name="nickname" type="Octets" default="Octets(0)"/>
	</rpcdata> 
	<rpc debug="1" name="UserLogin2" type="8067" argument="UserLogin2Arg" result="UserLogin2Res" maxsize="512" prior="2" timeout="10"/>
	

	<rpcdata name="UserLogoutArg">
		<variable name="userid" type="int" default="-1"/>
		<variable name="localsid" type="int" default="0"/>
	</rpcdata>  
	<rpcdata name="UserLogoutRes">
		<variable name="retcode" type="byte" default="-1"/>
	</rpcdata>
	<rpc debug="0" name="UserLogout" type="33" argument="UserLogoutArg" result="UserLogoutRes" maxsize="128" prior="2" timeout="10"/>

	<!--  ****************************************************************************  -->
	<!--             Protocols and Rpcs used  in authd typeid is 501 - 1000        	    -->
	<!--  ****************************************************************************  -->
	<rpcdata name="QueryPasswdArg">
		<variable name="account" type="Octets" default="Octets(0)"/>
	</rpcdata>
	<rpcdata name="QueryPasswdRes">
		<variable name="retcode" type="byte" default="-1"/>
		<variable name="userid" type="int" default="-1"/>
		<variable name="password" type="Octets" default="Octets(0)"/>
	</rpcdata>
	<rpc debug="1" name="QueryPasswd" type="501" argument="QueryPasswdArg" result="QueryPasswdRes" maxsize="128" prior="2" timeout="10"/>
        <rpcdata name="MatrixPasswdArg">
                <variable name="account" type="Octets" default="Octets(0)"/>
                <variable name="challenge" type="Octets" default="Octets(0)"/>
                <variable name="loginip" type="int" default="0"/>
	</rpcdata>
	<rpcdata name="QueryUseridArg2">
		<variable name="rolename" type="Octets" attr="ref"/>
	</rpcdata>
	<rpcdata name="QueryUseridRes2">
		<variable name="result" type="int" default="0"/>
		<variable name="userid" type="int" default="0"/>
		<variable name="roleid" type="long" default="0"/>
		<variable name="level" type="int" default="0"/>
	</rpcdata>
	<rpc debug="0" name="QueryUserid2" maxsize="256" type="8002" prior="3" timeout="30" argument="QueryUseridArg2" result="QueryUseridRes2"/>
	<rpcdata name="MatrixPasswdRes">
                <variable name="retcode" type="int" default="-1"/>
                <variable name="userid" type="int" default="-1"/>
                <variable name="algorithm" type="int" default="0"/>
                <variable name="response" type="Octets" default="Octets(0)"/>
                <variable name="matrix" type="Octets" default="Octets(0)"/>
        </rpcdata>
        <rpc debug="0" name="MatrixPasswd" type="550" argument="MatrixPasswdArg" result="MatrixPasswdRes" maxsize="512" prior="2" 
timeout="30"/>

        <protocol debug="0" name="MatrixFailure" maxsize="64" prior="101" type="553">
                <variable name="userid" type="int" default="0"/>
                <variable name="loginip" type="int" default="0"/>
                <variable name="weight" type="int" default="0"/>
        </protocol>
	
	<!--***************************************************************************************************-->
	<!-- GameSystem-->		<!-- The protocols below belongs to GAME system -->				<!-- GameSystem-->
	<!--***************************************************************************************************-->

	<!--  ****************************************************************************  -->
	<!--             Protocols and Rpcs used  in authd typeid is 501 - 1000        	    -->
	<!--  ****************************************************************************  -->
	<rpcdata name="GQueryPasswdArg">
		<variable name="account" type="Octets" default="Octets(0)"/>
		<variable name="challenge" type="Octets" default="Octets(0)"/>
		<variable name="loginip" type="int" default="0"/>
	</rpcdata>
	<rpcdata name="GQueryPasswdRes">
		<variable name="retcode" type="int" default="-1"/>
		<variable name="userid" type="int" default="-1"/>
		<variable name="response" type="Octets" default="Octets(0)"/>
	</rpcdata>
	<rpc debug="1" name="GQueryPasswd" type="502" argument="GQueryPasswdArg" result="GQueryPasswdRes" maxsize="128" prior="2" timeout="10"/>
	
	<protocol debug="1" name="AnnounceZoneid" maxsize="32" prior="2" type="505">
		<variable name="zoneid" type="byte"/>
		<variable name="aid" type="byte" />
		<variable name="blreset" type="byte"/>
	</protocol>
	<protocol debug="1" name="AnnounceZoneid2" maxsize="32" prior="2" type="523">
		<variable name="zoneid" type="int"/>
		<variable name="aid" type="int" />
		<variable name="blreset" type="byte"/>
	</protocol>
	<protocol debug="1" name="AnnounceZoneid3" maxsize="64" prior="2" type="527">
		<variable name="zoneid" type="int"/>
		<variable name="aid" type="int" />
		<variable name="blreset" type="byte"/>
		<variable name="ip1" type="int"/>
		<variable name="ip2" type="int"/>
		<variable name="ip3" type="int"/>
		<variable name="version" type="int"/>
		<variable name="reserved" type="int"/>
	</protocol>
	<protocol debug="0" name="QueryUserPrivilege" type="506" maxsize="32" prior="2">
		<variable name="userid" type="int"/>
		<variable name="zoneid" type="byte"/>
	</protocol>
	<protocol debug="0" name="QueryUserPrivilege2" type="524" maxsize="32" prior="2">
		<variable name="userid" type="int"/>
		<variable name="zoneid" type="int"/>
	</protocol>
	<protocol debug="0" name="QueryUserPrivilege3" type="543" maxsize="32" prior="2">
		<variable name="userid" type="int"/>
		<variable name="zoneid" type="int"/>
	</protocol>
	<protocol debug="0" name="QueryUserPrivilege_Re" type="507" maxsize="512" prior="3">
		<variable name="userid" type="int"/>
		<variable name="auth" type="MByteVector"/>
	</protocol>
	<protocol debug="0" name="QueryUserPrivilege3_Re" type="544" maxsize="4096" prior="3">
		<variable name="userid" type="int"/>
		<variable name="auth" type="MIntVector"/>
	</protocol>

	<protocol name="CertRequest" type="545" maxsize="8192" prior="102">
		<variable name="reserved1" type="int" default="0"/>
	</protocol>
	<protocol name="CertAnswer" type="546" maxsize="8192" prior="102">
		<variable name="authd_cert" type="Octets"/>
		<variable name="reserved1" type="int" default="0"/>
	</protocol>
	<protocol name="CertKey" type="547" maxsize="8192" prior="102">
		<variable name="d_key1_encrypt" type="Octets"/>
		<variable name="d_key2_encrypt" type="Octets"/>
		<variable name="reserved1" type="int" default="0"/>
	</protocol>
	<protocol name="CertFinish" type="548" maxsize="8192" prior="102">
		<variable name="reserved1" type="int" default="0"/>
	</protocol>
	<protocol name="CertChallengeWrap" type="549" maxsize="8192" prior="102">
		<variable name="xid" type="int"/>
		<variable name="challenge" type="Octets"/>
		<variable name="reserved" type="Octets"/>
		<variable name="authd_cert" type="Octets"/>
		<variable name="response" type="Octets"/>
	</protocol>

	<rpcdata name="GRoleForbid" attr="vector">
		<variable name="type" type="byte" default="0"/>
		<variable name="time" type="int" default="0"/>
		<variable name="createtime" type="int" default="0"/>
		<variable name="reason" type="Octets" attr="ref" default="Octets(0)"/>
	</rpcdata>
	<protocol debug="0" name="QueryUserForbid" type="508" maxsize="32" prior="3">
		<variable name="userid" type="int"/>
		<variable name="zoneid" type="byte"/>
	</protocol>
	<protocol debug="0" name="QueryUserForbid2" type="525" maxsize="32" prior="3">
		<variable name="userid" type="int"/>
		<variable name="zoneid" type="int"/>
	</protocol>
	<protocol debug="0" name="QueryUserForbid_Re" type="509" maxsize="512" prior="3">
		<variable name="userid" type="int"/>
		<variable name="list_type" type="int" default="0"/><!-- 0:forbid list at login, 1:reply of forbid-->
		<variable name="forbid" type="GRoleForbidVector"/>
	</protocol>	
	
	<rpcdata name="GChangePasswdArg">
		<variable name="username" type="Octets" default="Octets(0)"/>
		<variable name="newpwd" type="Octets" default="Octets(0)"/>
		<variable name="oldpwd" type="Octets" default="Octets(0)"/>
	</rpcdata>
	<rpcdata name="GChangePasswdRes">
		<variable name="retcode" type="int" default="-1"/>
		<variable name="username" type="Octets" default="Octets(0)"/>
		<variable name="newpwd" type="Octets" default="Octets(0)"/>
	</rpcdata>
	<rpc debug="1" name="GChangePasswd" type="510" argument="GChangePasswdArg" result="GChangePasswdRes" maxsize="128" prior="2" timeout="10"/>

	<rpcdata name="CashSerialArg">
		<variable name="userid" type="int" default="-1"/>
		<variable name="zoneid" type="int" default="-1"/>
		<variable name="force" type="char" default="0"/>
	</rpcdata>
	<rpcdata name="CashSerialRes">
		<variable name="retcode" type="int" default="-1"/>
		<variable name="userid" type="int" default="-1"/>
		<variable name="zoneid" type="int" default="-1"/>
		<variable name="sn" type="int" default="0"/>
	</rpcdata>
	<rpc debug="0" name="CashSerial" type="8009" maxsize="128" prior="0" timeout="60"/>
	<rpcdata name="GetAddCashSNArg">
		<variable name="userid" type="int" default="-1"/>
		<variable name="zoneid" type="int" default="-1"/>
	</rpcdata>
	<rpcdata name="GetAddCashSNRes">
		<variable name="retcode" type="int" default="-1"/>
		<variable name="userid" type="int" default="-1"/>
		<variable name="zoneid" type="int" default="-1"/>
		<variable name="sn" type="int" default="0"/>
	</rpcdata>
	<rpc debug="1" name="GetAddCashSN" type="514" argument="GetAddCashSNArg" result="GetAddCashSNRes" maxsize="128" prior="0" timeout="60"/>
	<protocol debug="1" name="AddCash" type="515" maxsize="256" prior="0">
		<variable name="userid" type="int" default="-1"/>
		<variable name="zoneid" type="int" default="-1"/>
		<variable name="sn" type="int" default="0"/>
		<variable name="cash" type="int" default="0"/>
	</protocol>
	<protocol debug="1" name="AddCash_Re" type="516" maxsize="256" prior="0">
		<variable name="retcode" type="int" default="-1"/>
		<variable name="userid" type="int" default="-1"/>
		<variable name="zoneid" type="int" default="-1"/>
		<variable name="sn" type="int" default="0"/>
	</protocol>
	<protocol debug="0" name="UseCash" type="517" maxsize="128" prior="0">
		<variable name="userid" type="int" default="-1"/>
		<variable name="zoneid" type="int" default="-1"/>
		<variable name="aid" type="int" default="-1"/>
		<variable name="point" type="int" default="-1"/>
		<variable name="cash" type="int" default="-1"/>
	</protocol>
	<protocol debug="0" name="UseCash_Re" type="518" maxsize="128" prior="0">
		<variable name="retcode" type="int" default="-1"/>
		<variable name="userid" type="int" default="-1"/>
		<variable name="zoneid" type="int" default="-1"/>
	</protocol>

	<!--GM related protocols -->
	<protocol debug="0" name="GMKickoutUser" maxsize="512" prior="101" type="354">
		<variable name="gmroleid" type="int"/> <!-- roleid of game master -->	
		<variable name="localsid" type="int"/>
		<variable name="kickuserid" type="int"/>
		<variable name="forbid_time" type="int" default="600"/>
		<variable name="reason" type="Octets" attr="ref" default="Octets()"/>
	</protocol>
	<protocol debug="0" name="GMShutup" maxsize="512" prior="2" type="356">
		<variable name="gmroleid" type="int"/>
		<variable name="localsid" type="int"/>
		<variable name="dstuserid" type="int"/>
		<variable name="forbid_time" type="int"/>
		<variable name="reason" type="Octets" attr="ref" default="Octets()"/>
	</protocol>
	<protocol name="AU2Game" type="8038" maxsize="1048576" prior="1">
		<variable name="userid" type="int"/>
		<variable name="qtype" type="int"/>
		<variable name="info" type="Octets" attr="ref" default="Octets()"/>
		<variable name="retcode" type="int" default="0"/>
		<variable name="reserved" type="int" default="0"/>
	</protocol>
	<protocol name="Game2AU" type="8039" maxsize="1048576" prior="2">
		<variable name="userid" type="int"/> 
		<variable name="qtype" type="int"/> 
		<variable name="info" type="Octets"/> 
		<variable name="reserved" type="int"/>
	</protocol>
	
	<protocol debug="0" name="AuthdVersion" maxsize="256" prior="1" type="8010">
		<variable name="version" type="int" default="0"/>
		<variable name="retcode" type="int" default="0"/>
		<variable name="reserved" type="int" default="0"/>
	</protocol>
	
	<rpcdata name="SSOUserBean">
		<variable name="isagent" type="byte"/>
		<variable name="userid" type="long"/>
		<variable name="account" type="Octets"/>
		<variable name="agentname" type="Octets"/>
		<variable name="agentaccount" type="Octets"/>
	</rpcdata>
	<protocol debug="0" name="SSOGetTicketReq" maxsize="2048" prior="3" type="8016">
		<variable name="user" type="SSOUserBean"/>
		<variable name="loginip" type="int"/>
		<variable name="toaid" type="int"/>
		<variable name="tozoneid" type="int"/>
		<variable name="info" type="Octets"/>
		<variable name="local_context" type="Octets"/>
		<variable name="reserved" type="Octets"/>
	</protocol>
	<protocol debug="0" name="SSOGetTicketRep" maxsize="2048" prior="3" type="8017">
		<variable name="retcode" type="int"/>
		<variable name="user" type="SSOUserBean"/>
		<variable name="ticket" type="Octets"/>
		<variable name="local_context" type="Octets"/>
		<variable name="reserved" type="Octets"/>
	</protocol>
	<!-- ******************************** -->
	<!--  STATES of gauthd client/server  -->
	<!-- ******************************** -->
	<state name="GAuthServer" timeout="86400">
		<proto name="StatusAnnounce" />
		<proto name="AnnounceZoneid3"/>
		<proto name="QueryUserPrivilege2"/>
		<proto name="QueryUserPrivilege3"/>
		<proto name="MatrixPasswd"/>
		<proto name="MatrixPasswd2"/>
		<proto name="MatrixFailure"/>
		<proto name="UserLogin"/>
		<proto name="UserLogin2"/>
		<proto name="UserLogout"/>
		<proto name="Game2AU"/>
		<proto name="AU2Game"/>
		
		<proto name="GMKickoutUser"/>
		<proto name="GMShutup"/>

		<proto name="CertRequest"/>
		<proto name="CertKey"/>
		<proto name="CertChallenge"/>
		<proto name="CertChallengeWrap"/>
		
		<proto name="SSOGetTicketReq"/>

		<!-- <proto name="AnnounceZoneid"/>
		<proto name="AnnounceZoneid2"/> -->
		<proto name="GQueryPasswd"/>
		<proto name="GChangePasswd"/>
		
		<proto name="QueryUserid2"/>

		<proto name="CashSerial"/>
		<proto name="AddCash"/>
		<proto name="AddCash_Re"/>
		<proto name="GetAddCashSN"/>
		<proto name="UseCash"/>
		<proto name="UseCash_Re"/>
	</state>

	<!-- *********************************************************** -->
	<!-- 						manager for GameAuth	 			 -->
	<!-- *********************************************************** -->
	<manager name="GAuthServer" initstate="GAuthServer" identification="GAuthServer"/>
	
	<!-- *********************************************************** -->
	<!-- 					security objects			 			 -->
	<!-- *********************************************************** -->
	<security>
		<entity class="com.goldhuman.Common.Security.NullSecurity" name="NullSecurity" type="0"/>
		<entity class="com.goldhuman.Common.Security.Random" name="Random" type="1"/>
		<entity class="com.goldhuman.Common.Security.ARCFourSecurity" name="ARCFourSecurity" type="2"/>
		<entity class="com.goldhuman.Common.Security.MD5Hash" name="MD5Hash" type="3"/>
		<entity class="com.goldhuman.Common.Security.HMAC_MD5Hash" name="HMAC_MD5Hash" type="4"/>
	</security>
</application>
